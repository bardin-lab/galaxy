{"version":3,"sources":["layout/generic-nav-view.js"],"names":["GenericNavView","Backbone","View","extend","initialize","this","modal","makeModalIframe","e","$el_chat_modal_header","$el_chat_modal_body","iframe_template","window","Galaxy","config","communication_server_host","communication_server_port","escape","user","attributes","username","persistent_communication_rooms","$","remove","header_template","_uiModal2","default","body","height","width","query_string","closing_events","class_names","title_separator","cls","show","frame_width","append","click","hasClass","addClass","attr","css","frame_height","removeClass","self","navItem","id","icon","tooltip","_localization2","render","onclick"],"mappings":"uOAGIA,EAAiBC,SAASC,KAAKC,QAC/BC,WAAY,WACRC,KAAKC,MAAQ,MAIjBC,gBAAiB,SAASC,GAEtB,IAUIC,EAAwB,KAbhCC,EAAA,KAEIC,EAAAA,+DACWC,OAAOC,OAAOC,OAAOC,0BARE,IAUvBH,OAAOC,OAAOC,OAAOE,2BATpCZ,aAUmBa,OAAOL,OAAOC,OAAOK,KAAKC,WAAWC,UAVxDhB,mCAYyCa,OAAOL,OAAOC,OAAOC,OAAOO,kCANjE,eAgEQC,OApDRA,EAAA,eAAIZ,OAAsB,GAetBY,EAAE,eAAeC,SAXrBvB,EAAIwB,MAAAA,IACAC,EAAAC,QAAAxB,MAcAyB,KAAMhB,EAVViB,OAAmB,IACnBC,MAdIC,IAeJC,gBAAIC,EAYAC,iBAAiB,EAVrBC,IAFkB,wBAMlBlC,EAAAM,MAAA6B,OACAnC,EAAAsB,EAAA,6BACIK,EAAMhB,EAAAA,2BAENkB,EAAOO,SAH2B,qBAIlCL,EAAAA,SAJkC,qBAKlCE,EAAAA,KAAiB,MALiBV,SAMlCW,EAAKF,WAAAA,6BAN6BvB,EAAtC4B,OA3BA,uPAoCAf,EAAA,gBAAAgB,MAAA,SAAA9B,GACAR,EAAAA,eAAeM,IAAM6B,UAArB,UAGAb,EAAA,0BAAAgB,MAAA,SAAA9B,GACAC,EAAAA,0BAA+B8B,SAAA,cAC/B7B,EAAAA,6BAA6BmB,MAAA,UAC7BpB,EAAAA,2BAAiCc,OAAjC,SACAd,EAAAA,0BACAA,YAAAA,aACA+B,SAAA,eACElB,EAAA,0BAAsBmB,KAAK,QAAA,YACzBnB,EAAE,0BAAmBoB,IAAW,cAAhC,WAEJpB,EAAA,6BAAAO,MAAAO,SACEd,EAAA,2BAAFM,OAAkCe,SAC9BrB,EAAA,0BACIA,YAAE,eACFA,SAAE,aACFA,EAAAA,0BAAEmB,KACGG,QAAAA,YAELtB,EAAAA,0BAAEoB,IAA0BD,cAAc,YAG1CnB,MAMAA,OAAAA,WACH,IAAAuB,EAAAxC,KASLyC,OAvFkCC,GAAA,mBAyF9BC,KAAM,eANdC,SAAA,EAAAC,EAAAxB,SAAA,eACAyB,SAAQ,EACJC,QAAIP,EAAOtC,+BAOP6C,eAAAA","file":"../../scripts/layout/generic-nav-view.js","sourcesContent":["import _l from \"utils/localization\";\n/** Real-time Communication feature **/\nimport Modal from \"mvc/ui/ui-modal\";\nvar GenericNavView = Backbone.View.extend({\n    initialize: function() {\n        this.modal = null;\n    },\n\n    /** makes bootstrap modal and iframe inside it */\n    makeModalIframe: function(e) {\n        // make modal\n        var host = window.Galaxy.config.communication_server_host;\n\n        var port = window.Galaxy.config.communication_server_port;\n        var username = escape(window.Galaxy.user.attributes.username);\n\n        var persistent_communication_rooms = escape(window.Galaxy.config.persistent_communication_rooms);\n\n        var query_string = `?username=${username}&persistent_communication_rooms=${persistent_communication_rooms}`;\n\n        var src = `${host}:${port}${query_string}`;\n        var $el_chat_modal_header = null;\n        var $el_chat_modal_body = null;\n\n        var iframe_template = `<iframe class=\"f-iframe fade in communication-iframe\" src=\"${src}\"> </iframe>`;\n\n        var header_template =\n            '<i class=\"fa fa-comment\" aria-hidden=\"true\" title=\"Communicate with other users\"></i>' +\n            '<i class=\"fa fa-expand expand-compress-modal\" aria-hidden=\"true\" title=\"Maximize\"></i>' +\n            '<i class=\"fa fa-times close-modal\" aria-hidden=\"true\" title=\"Close\"></i>';\n\n        var frame_height = 350;\n        var frame_width = 600;\n        var class_names = \"ui-modal chat-modal\";\n\n        // deletes the chat modal if already present and create one\n        if ($(\".chat-modal\").length > 0) {\n            $(\".chat-modal\").remove();\n        }\n        // creates a modal\n        GenericNavView.modal = new Modal.View({\n            body: iframe_template,\n            height: frame_height,\n            width: frame_width,\n            closing_events: true,\n            title_separator: false,\n            cls: class_names\n        });\n\n        // shows modal\n        GenericNavView.modal.show();\n        $el_chat_modal_header = $(\".chat-modal .modal-header\");\n        $el_chat_modal_body = $(\".chat-modal .modal-body\");\n        // adjusts the css of bootstrap modal for chat\n        $el_chat_modal_header.addClass(\"modal-header-body\");\n        $el_chat_modal_body.addClass(\"modal-header-body\");\n        $el_chat_modal_header.find(\"h4\").remove();\n        $el_chat_modal_header.removeAttr(\"min-height padding border\");\n        $el_chat_modal_header.append(header_template);\n        // click event of the close button for chat\n        $(\".close-modal\").click(e => {\n            $(\".chat-modal\").css(\"display\", \"none\");\n        });\n        // click event of expand and compress icon\n        $(\".expand-compress-modal\").click(e => {\n            if ($(\".expand-compress-modal\").hasClass(\"fa-expand\")) {\n                $(\".chat-modal .modal-dialog\").width(\"1000px\");\n                $(\".chat-modal .modal-body\").height(\"575px\");\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-expand\")\n                    .addClass(\"fa-compress\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Minimize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"96.2%\");\n            } else {\n                $(\".chat-modal .modal-dialog\").width(`${frame_width}px`);\n                $(\".chat-modal .modal-body\").height(`${frame_height}px`);\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-compress\")\n                    .addClass(\"fa-expand\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Maximize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"93.2%\");\n            }\n        });\n        return this;\n    },\n\n    /**renders the chat icon as a nav item*/\n    render: function() {\n        var self = this;\n        var navItem = {};\n        navItem = {\n            id: \"show-chat-online\",\n            icon: \"fa-comment-o\",\n            tooltip: _l(\"Chat online\"),\n            visible: false,\n            onclick: self.makeModalIframe\n        };\n        return navItem;\n    }\n});\n\nexport default {\n    GenericNavView: GenericNavView\n};\n"]}