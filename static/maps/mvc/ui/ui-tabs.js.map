{"version":3,"sources":["mvc/ui/ui-tabs.js"],"names":["View","Backbone","extend","initialize","options","this","collection","Collection","model","Model","set","setElement","$","onchange","visible","$el","render","listenTo","on","_add","_remove","_change","id","get","length","first","$nav","children","removeClass","addClass","$content","size","current","show","hide","add","del","remove","delAll","reset","showTab","hideTab","self","tab_model","attributes","append","title","placement","container","tooltip","preventDefault","e","_reset","empty","_template","$href","icon","attr","$tmpl","_template_tab","find"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-tabs.js","sourcesContent":["/**\n *  Renders tabs e.g. used in the charts editor, behaves similar to repeat and section rendering\n */\nexport var View = Backbone.View.extend({\n    initialize: function(options) {\n        this.collection = new Backbone.Collection();\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                onchange: null,\n                visible: true\n            }).set(options);\n        this.setElement($(this._template()));\n        this.$nav = this.$(\".tab-navigation\");\n        this.$content = this.$(\".tab-content\");\n        this.$el.on(\"click\", () => {\n            $(\".tooltip\").hide();\n        });\n        this.render();\n        this.listenTo(this.model, \"change\", this.render, this);\n        this.listenTo(this.collection, \"add\", this._add, this);\n        this.listenTo(this.collection, \"remove\", this._remove, this);\n        this.listenTo(this.collection, \"change\", this._change, this);\n        this.listenTo(this.collection, \"reset\", this._reset, this);\n        this.listenTo(this.collection, \"add remove reset\", this.render, this);\n    },\n\n    render: function() {\n        var id = this.model.get(\"current\");\n        id = this.$(`#${id}`).length > 0 ? id : this.first();\n        if (id) {\n            this.$nav.children().removeClass(\"active\");\n            this.$content.children().removeClass(\"active\");\n            this.$(`#tab-${id}`).addClass(\"active\");\n            this.$(`#${id}`).addClass(\"active\");\n        }\n        this.$el[this.model.get(\"visible\") ? \"fadeIn\" : \"fadeOut\"](\"fast\");\n        this.$nav[this.size() > 1 ? \"show\" : \"hide\"]();\n    },\n\n    /** Returns tab id for currently shown tab */\n    current: function() {\n        return this.model.get(\"current\");\n    },\n\n    /** Show tab view and highlight a tab by id */\n    show: function(id) {\n        if (id) {\n            this.model.set({ current: id, visible: true });\n            this.model.get(\"onchange\") && this.model.get(\"onchange\")(id);\n        }\n    },\n\n    /** Hide tab view */\n    hide: function() {\n        this.model.set(\"visible\", false);\n    },\n\n    /** Returns first tab */\n    first: function() {\n        var model = this.collection.first();\n        return model && model.id;\n    },\n\n    /** Returns current number of tabs */\n    size: function() {\n        return this.collection.length;\n    },\n\n    /** Adds a new tab */\n    add: function(options) {\n        this.collection.add(options);\n    },\n\n    /** Delete tab */\n    del: function(id) {\n        this.collection.remove(id);\n    },\n\n    /** Delete all tabs */\n    delAll: function() {\n        this.collection.reset();\n    },\n\n    /** Show tab */\n    showTab: function(id) {\n        this.collection.get(id).set(\"hidden\", false);\n    },\n\n    /** Hide tab */\n    hideTab: function(id) {\n        this.collection.get(id).set(\"hidden\", true);\n    },\n\n    /** Adds a new tab */\n    _add: function(tab_model) {\n        var self = this;\n        var options = tab_model.attributes;\n        this.$content.append(\n            $(\"<div/>\")\n                .attr(\"id\", options.id)\n                .addClass(\"tab-pane\")\n                .append(options.$el)\n        );\n        this.$nav.append(\n            $(this._template_tab(options))\n                .show()\n                .tooltip({\n                    title: options.tooltip,\n                    placement: \"bottom\",\n                    container: self.$el\n                })\n                .on(\"click\", e => {\n                    e.preventDefault();\n                    self.show(options.id);\n                })\n        );\n        if (this.size() == 1) {\n            this.show(options.id);\n        }\n    },\n\n    /** Delete tab */\n    _remove: function(tab_model) {\n        this.$(`#tab-${tab_model.id}`).remove();\n        this.$(`#${tab_model.id}`).remove();\n    },\n\n    /** Reset collection */\n    _reset: function() {\n        this.$nav.empty();\n        this.$content.empty();\n    },\n\n    /** Change tab */\n    _change: function(tab_model) {\n        this.$(`#tab-${tab_model.id}`)[tab_model.get(\"hidden\") ? \"hide\" : \"show\"]();\n    },\n\n    /** Main template */\n    _template: function() {\n        return $(\"<div/>\")\n            .addClass(\"ui-tabs tabbable tabs-left\")\n            .append($(\"<ul/>\").addClass(\"tab-navigation nav nav-tabs\"))\n            .append($(\"<div/>\").addClass(\"tab-content\"));\n    },\n\n    /** Tab template */\n    _template_tab: function(options) {\n        var $tmpl = $(\"<li/>\")\n            .addClass(\"tab-element\")\n            .attr(\"id\", `tab-${options.id}`)\n            .append($(\"<a/>\").attr(\"id\", `tab-title-link-${options.id}`));\n        var $href = $tmpl.find(\"a\");\n        options.icon &&\n            $href.append(\n                $(\"<i/>\")\n                    .addClass(\"tab-icon fa\")\n                    .addClass(options.icon)\n            );\n        $href.append(\n            $(\"<span/>\")\n                .attr(\"id\", `tab-title-text-${options.id}`)\n                .addClass(\"tab-title-text\")\n                .append(options.title)\n        );\n        return $tmpl;\n    }\n});\n\nexport default { View: View };\n"]}